
inception_v3 base model with input shape (None, 299, 299, 3) loaded.

Creating camera groups...
Camera groups already exist.

Creating capture event groups...
Capture event groups already exist.

Data Summary: ./research/ssu_preserves/images 

              Class                         Group   Count
---------------------------------------------------------
             bobcat              LowerTrailCamera     234
                        NorthernTowerMeadowCamera      27
                                    SODPlotCamera      31
                               UpperMostROWCamera     141
                      UpperROWWoodChipFieldCamera      61
                                 UpperTrailCamera      82
                                            Total     576
---------------------------------------------------------
             coyote              LowerTrailCamera      13
                        NorthernTowerMeadowCamera       3
                                    SODPlotCamera      30
                               UpperMostROWCamera      52
                      UpperROWWoodChipFieldCamera      20
                                 UpperTrailCamera      79
                                            Total     197
---------------------------------------------------------
               crow                 SODPlotCamera       3
                               UpperMostROWCamera       2
                                            Total       5
---------------------------------------------------------
               deer              LowerTrailCamera     380
                        NorthernTowerMeadowCamera     718
                                    SODPlotCamera     831
                               UpperMostROWCamera    1891
                      UpperROWWoodChipFieldCamera     211
                                 UpperTrailCamera     194
                                            Total    4225
---------------------------------------------------------
                dog              LowerTrailCamera      29
                               UpperMostROWCamera       8
                                            Total      37
---------------------------------------------------------
                fox              LowerTrailCamera      80
                        NorthernTowerMeadowCamera       6
                                    SODPlotCamera       1
                                            Total      87
---------------------------------------------------------
               hawk              LowerTrailCamera       2
                        NorthernTowerMeadowCamera       3
                                            Total       5
---------------------------------------------------------
              human              LowerTrailCamera    1750
                        NorthernTowerMeadowCamera      10
                                    SODPlotCamera     237
                               UpperMostROWCamera     126
                      UpperROWWoodChipFieldCamera       9
                                 UpperTrailCamera      43
                                            Total    2175
---------------------------------------------------------
miscellaneous birds            UpperMostROWCamera       9
                      UpperROWWoodChipFieldCamera      24
                                            Total      33
---------------------------------------------------------
       mountainlion              LowerTrailCamera      12
                      UpperROWWoodChipFieldCamera       3
                                 UpperTrailCamera       3
                                            Total      18
---------------------------------------------------------
              mouse              LowerTrailCamera      15
                        NorthernTowerMeadowCamera       2
                                            Total      17
---------------------------------------------------------
           multiple     NorthernTowerMeadowCamera       3
                               UpperMostROWCamera      17
                                            Total      20
---------------------------------------------------------
            nothing              LowerTrailCamera    4738
                        NorthernTowerMeadowCamera    2115
                                    SODPlotCamera     654
                               UpperMostROWCamera    1167
                      UpperROWWoodChipFieldCamera    1594
                                 UpperTrailCamera     167
                                            Total   10435
---------------------------------------------------------
                owl                 SODPlotCamera       2
                      UpperROWWoodChipFieldCamera       3
                                            Total       5
---------------------------------------------------------
                                            Total       0
---------------------------------------------------------
             possum              LowerTrailCamera     135
                        NorthernTowerMeadowCamera      50
                                    SODPlotCamera     201
                               UpperMostROWCamera      49
                      UpperROWWoodChipFieldCamera      14
                                 UpperTrailCamera      69
                                            Total     518
---------------------------------------------------------
              quail              LowerTrailCamera      11
                                    SODPlotCamera       3
                               UpperMostROWCamera       3
                      UpperROWWoodChipFieldCamera       7
                                            Total      24
---------------------------------------------------------
             rabbit              LowerTrailCamera     460
                        NorthernTowerMeadowCamera      18
                                    SODPlotCamera      24
                               UpperMostROWCamera     766
                      UpperROWWoodChipFieldCamera     424
                                 UpperTrailCamera     120
                                            Total    1812
---------------------------------------------------------
            raccoon              LowerTrailCamera      11
                                    SODPlotCamera       4
                                            Total      15
---------------------------------------------------------
              raven              LowerTrailCamera      22
                        NorthernTowerMeadowCamera      12
                                            Total      34
---------------------------------------------------------
              skunk              LowerTrailCamera     232
                        NorthernTowerMeadowCamera      46
                                    SODPlotCamera     144
                               UpperMostROWCamera      65
                      UpperROWWoodChipFieldCamera      18
                                 UpperTrailCamera      84
                                            Total     589
---------------------------------------------------------
           squirrel              LowerTrailCamera     702
                        NorthernTowerMeadowCamera     450
                                    SODPlotCamera     921
                               UpperMostROWCamera     250
                      UpperROWWoodChipFieldCamera     103
                                            Total    2426
---------------------------------------------------------
      stellar_s jay                       unknown       6
                                            Total       6
---------------------------------------------------------
             turkey              LowerTrailCamera     197
                        NorthernTowerMeadowCamera     121
                                    SODPlotCamera     121
                               UpperMostROWCamera      50
                      UpperROWWoodChipFieldCamera     157
                                            Total     646
---------------------------------------------------------
            unknown              LowerTrailCamera     214
                        NorthernTowerMeadowCamera     156
                                    SODPlotCamera     125
                               UpperMostROWCamera     355
                      UpperROWWoodChipFieldCamera     105
                                 UpperTrailCamera      88
                                            Total    1043
---------------------------------------------------------
            vehicle            UpperMostROWCamera      18
                                            Total      18
---------------------------------------------------------
26 classes | 7 groups | 24966 images
median class size: 35.5 | mad: 33.0
mean class size: 960.23 | sd: 2140.91
median group size: 3332.0 | mad: 1637.0
mean group size: 3566.57 | sd: 2790.34

class,LowerTrailCamera,NorthernTowerMeadowCamera,SODPlotCamera,UpperMostROWCamera,UpperROWWoodChipFieldCamera,UpperTrailCamera,unknown,total
bobcat,234,27,31,141,61,82,0,576
coyote,13,3,30,52,20,79,0,197
crow,0,0,3,2,0,0,0,5
deer,380,718,831,1891,211,194,0,4225
dog,29,0,0,8,0,0,0,37
fox,80,6,1,0,0,0,0,87
hawk,2,3,0,0,0,0,0,5
human,1750,10,237,126,9,43,0,2175
miscellaneous birds,0,0,0,9,24,0,0,33
mountainlion,12,0,0,0,3,3,0,18
mouse,15,2,0,0,0,0,0,17
multiple,0,3,0,17,0,0,0,20
nothing,4738,2115,654,1167,1594,167,0,10435
owl,0,0,2,0,3,0,0,5
pig,0,0,0,0,0,0,0,0
possum,135,50,201,49,14,69,0,518
quail,11,0,3,3,7,0,0,24
rabbit,460,18,24,766,424,120,0,1812
raccoon,11,0,4,0,0,0,0,15
raven,22,12,0,0,0,0,0,34
skunk,232,46,144,65,18,84,0,589
squirrel,702,450,921,250,103,0,0,2426
stellar_s jay,0,0,0,0,0,0,6,6
turkey,197,121,121,50,157,0,0,646
unknown,214,156,125,355,105,88,0,1043
vehicle,0,0,0,18,0,0,0,18
total,9237,3740,3332,4969,2753,929,6,24966
csv saved to ./research/ssu_preserves/tmp/data_summary.csv

Generating bottlenecks...
Bottlenecks already exist.
Loading bottlenecks...
./research/ssu_preserves/tmp/inception_v3-global_average_pooling2d_1-bottlenecks.h5 loaded.

Making birds class from ('raven', 'miscellaneous birds', 'quail', 'stellar_s jay', 'crow', 'hawk', 'owl')
Updating class numbers...
Removing ('UpperMostROWCamera', 'NorthernTowerMeadowCamera', 'UpperROWWoodChipFieldCamera', 'UpperTrailCamera', 'SODPlotCamera') groups.
Removing ('dog', 'mountainlion', 'vehicle', 'mouse', 'raccoon', 'pig', 'unknown', 'multiple', 'fox', 'coyote', 'birds') classes.
Updating class numbers...
bobcat   234
deer   380
human   1750
nothing   4738
possum   135
rabbit   460
skunk   232
squirrel   702
turkey   197
Removing ['possum', 'turkey'] classes less than  200
Updating class numbers...

Performing group 5-fold cross validation...
Fold 1/5
Before resample:
File count of test: 1700
File count of train: 6796
File count of intersection  of test and train: 0
Oversampling to balance classes in training set.
Training set sizes will be at least 1.0 times max training set class size of 3790.
Class number 0 training set size changed: 185 -> 3790
Class number 1 training set size changed: 300 -> 3790
Class number 2 training set size changed: 1402 -> 3790
Class number 4 training set size changed: 372 -> 3790
Class number 5 training set size changed: 183 -> 3790
Class number 6 training set size changed: 564 -> 3790
File count of test: 1700
File count of train: 6796
File count of intersection  of test and train: 0
Epoch 1/5
 - 1s - loss: 0.5348 - acc: 0.8248
Epoch 2/5
 - 0s - loss: 0.1877 - acc: 0.9380
Epoch 3/5
 - 0s - loss: 0.1228 - acc: 0.9606
Epoch 4/5
 - 0s - loss: 0.0924 - acc: 0.9715
Epoch 5/5
 - 0s - loss: 0.0692 - acc: 0.9795
Accuracy: 0.8865
F1 Scores: [0.80434783 0.84848485 0.95348837 0.92079208 0.77319588 0.76
 0.71137026]
                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat       37        5        0        0        4        3        0 
        deer        2       70        1        3        2        1        1 
       human        1        0      328        8        2        0        9 
     nothing        0        9       11      837       17        6       68 
      rabbit        1        0        0        4       75        3        5 
       skunk        1        0        0        6        4       38        0 
    squirrel        1        1        0       12        2        0      122 

Fold 2/5
Before resample:
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Oversampling to balance classes in training set.
Training set sizes will be at least 1.0 times max training set class size of 3780.
Class number 0 training set size changed: 185 -> 3780
Class number 1 training set size changed: 311 -> 3780
Class number 2 training set size changed: 1405 -> 3780
Class number 4 training set size changed: 366 -> 3780
Class number 5 training set size changed: 189 -> 3780
Class number 6 training set size changed: 561 -> 3780
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Epoch 1/5
 - 1s - loss: 0.5639 - acc: 0.8204
Epoch 2/5
 - 0s - loss: 0.1737 - acc: 0.9447
Epoch 3/5
 - 0s - loss: 0.1178 - acc: 0.9626
Epoch 4/5
 - 0s - loss: 0.0884 - acc: 0.9751
Epoch 5/5
 - 0s - loss: 0.0727 - acc: 0.9780
Accuracy: 0.8746
F1 Scores: [0.8        0.76119403 0.91906722 0.91615769 0.78723404 0.70175439
 0.72782875]
                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat       42        1        0        0        5        1        0 
        deer        3       51        3        2        2        1        7 
       human        0        2      335        2        1        0        5 
     nothing        2        7       34      825       12       25       53 
      rabbit        7        4        2        1       74        4        2 
       skunk        2        0        0        1        0       40        0 
    squirrel        0        0       10       12        0        0      119 

Fold 3/5
Before resample:
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Oversampling to balance classes in training set.
Training set sizes will be at least 1.0 times max training set class size of 3793.
Class number 0 training set size changed: 195 -> 3793
Class number 1 training set size changed: 300 -> 3793
Class number 2 training set size changed: 1408 -> 3793
Class number 4 training set size changed: 360 -> 3793
Class number 5 training set size changed: 184 -> 3793
Class number 6 training set size changed: 557 -> 3793
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Epoch 1/5
 - 1s - loss: 0.6087 - acc: 0.8032
Epoch 2/5
 - 0s - loss: 0.1996 - acc: 0.9357
Epoch 3/5
 - 0s - loss: 0.1326 - acc: 0.9594
Epoch 4/5
 - 0s - loss: 0.0968 - acc: 0.9697
Epoch 5/5
 - 0s - loss: 0.0726 - acc: 0.9784
Accuracy: 0.9141
F1 Scores: [0.77922078 0.86705202 0.93704246 0.94891304 0.84577114 0.83673469
 0.79141104]
                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat       30        3        0        0        4        0        2 
        deer        0       75        0        3        0        0        2 
       human        0        3      320       11        0        0        8 
     nothing        1        7       13      873        8        5       38 
      rabbit        6        2        0        1       85        4        2 
       skunk        1        0        0        2        4       41        0 
    squirrel        0        3        8        5        0        0      129 

Fold 4/5
Before resample:
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Oversampling to balance classes in training set.
Training set sizes will be at least 1.0 times max training set class size of 3794.
Class number 0 training set size changed: 181 -> 3794
Class number 1 training set size changed: 307 -> 3794
Class number 2 training set size changed: 1392 -> 3794
Class number 4 training set size changed: 370 -> 3794
Class number 5 training set size changed: 185 -> 3794
Class number 6 training set size changed: 568 -> 3794
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Epoch 1/5
 - 1s - loss: 0.6343 - acc: 0.8024
Epoch 2/5
 - 0s - loss: 0.2041 - acc: 0.9334
Epoch 3/5
 - 0s - loss: 0.1319 - acc: 0.9596
Epoch 4/5
 - 0s - loss: 0.0968 - acc: 0.9706
Epoch 5/5
 - 0s - loss: 0.0764 - acc: 0.9775
Accuracy: 0.9117
F1 Scores: [0.87272727 0.90196078 0.96561605 0.93901781 0.74853801 0.74193548
 0.79584775]
                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat       48        1        0        0        2        2        0 
        deer        0       69        0        2        0        1        1 
       human        0        1      337       15        1        0        4 
     nothing        4        3        3      870       11       26       27 
      rabbit        3        4        0        9       64        2        8 
       skunk        0        1        0        0        0       46        0 
    squirrel        2        1        0       13        3        0      115 

Fold 5/5
Before resample:
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Oversampling to balance classes in training set.
Training set sizes will be at least 1.0 times max training set class size of 3795.
Class number 0 training set size changed: 190 -> 3795
Class number 1 training set size changed: 302 -> 3795
Class number 2 training set size changed: 1393 -> 3795
Class number 4 training set size changed: 372 -> 3795
Class number 5 training set size changed: 187 -> 3795
Class number 6 training set size changed: 558 -> 3795
File count of test: 1699
File count of train: 6797
File count of intersection  of test and train: 0
Epoch 1/5
 - 1s - loss: 0.5486 - acc: 0.8217
Epoch 2/5
 - 0s - loss: 0.1855 - acc: 0.9407
Epoch 3/5
 - 0s - loss: 0.1215 - acc: 0.9624
Epoch 4/5
 - 0s - loss: 0.0913 - acc: 0.9721
Epoch 5/5
 - 0s - loss: 0.0724 - acc: 0.9790
Accuracy: 0.8929
F1 Scores: [0.79207921 0.75675676 0.93681319 0.92615214 0.79227053 0.82978723
 0.78369906]
                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat       40        0        0        0        1        0        3 
        deer        5       56        0        3        7        0        7 
       human        0        4      341        8        1        0        3 
     nothing        8       10       23      834       25        8       35 
      rabbit        2        0        0        1       82        1        2 
       skunk        2        0        0        2        2       39        0 
    squirrel        0        0        7       10        1        1      125 

--- 5-Fold Cross Validation Results ---
Average Accuracy: 0.8960 | Standard Deviation: 0.0150
Accuracy by fold: [0.8864705882352941, 0.8746321365509123, 0.9140670982931136, 0.9117127722189523, 0.8928781636256622]
Average F1 Score overall: 0.8336 | Standard Deviation: 0.0680
Average F1 Score by class: [0.80967502 0.82708969 0.94240546 0.93020655 0.78940192 0.77404236
 0.76203137]

                      --- Confusion Matrix (actual, predicted) ---         
               bobcat     deer    human  nothing   rabbit    skunk squirrel 
      bobcat     0.84     0.04     0.00     0.00     0.07     0.03     0.02 
        deer     0.03     0.84     0.01     0.03     0.03     0.01     0.05 
       human     0.00     0.01     0.95     0.03     0.00     0.00     0.02 
     nothing     0.00     0.01     0.02     0.89     0.02     0.01     0.05 
      rabbit     0.04     0.02     0.00     0.03     0.83     0.03     0.04 
       skunk     0.03     0.00     0.00     0.05     0.04     0.88     0.00 
    squirrel     0.00     0.01     0.04     0.07     0.01     0.00     0.87 

                               --- Class Balance ---                     
             bobcat     deer    human  nothing   rabbit    skunk squirrel 
    Fold 1       49       80      348      948       88       49      138 
    Fold 2       49       69      345      958       94       43      141 
    Fold 3       39       80      342      945      100       48      145 
    Fold 4       53       73      358      944       90       47      134 
    Fold 5       44       78      357      943       88       45      144 
     Total      234      380     1750     4738      460      232      702 

--- Hyperparameter & Model Summary ---
Base Model: inception_v3
Feature Layer: global_average_pooling2d_1
Batch Size: 512
Epochs: 5
Dropout Rate: 0.5
Optimizer: <keras.optimizers.Adam object at 0x7fb0ed8144a8>
Optimizer Config: {'beta_1': 0.8999999761581421, 'decay': 0.0, 'epsilon': 1e-08, 'lr': 0.0010000000474974513, 'beta_2': 0.9990000128746033, 'clipnorm': 1.0}
Final Layers:
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_9 (Dense)              (None, 1024)              2098176   
_________________________________________________________________
dropout_5 (Dropout)          (None, 1024)              0         
_________________________________________________________________
dense_10 (Dense)             (None, 7)                 7175      
=================================================================
Total params: 2,105,351
Trainable params: 2,105,351
Non-trainable params: 0
_________________________________________________________________

--- Misclassified Files ---
random sample of 25 misclassified images saved to ./research/ssu_preserves/tmp/results/misclassified_images.jpg
random sample of 25 correctly classified images saved to ./research/ssu_preserves/tmp/results/classified_images.jpg
csv of all misclassified images saved to ./research/ssu_preserves/tmp/results/misclassified_images.csv
csv of all classified images saved to ./research/ssu_preserves/tmp/results/classified_images.csv
